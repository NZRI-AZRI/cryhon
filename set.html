<!doctype html>
<html>
<head>
    <!-- icon -->

    
    <title>Crypto-bon setting</title>
    <meta charset="utf-8" />
    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- web3 js (LGPL-3.0のため、コンテンツ含む単一実行ファイルのソースコードを公開しなければいけないができないので廃止予定)    -->
    <script type="text/javascript" src="./web3.min.js"></script>

    <!--Ethers js (MIT　こちらを採用する。)-->
    <script type="text/javascript" src="./ethers-5.0.umd.min.js" ></script>
    
    <!--QR code write (MIT) -->
    <script type="text/javascript" src="./qrcode.min.js"></script>

    <!--cypto js (MIT)-->



    <style type="text/css">
        .box4{
        padding: 8px 19px;
        margin: 2em 0;
        color: #2c2c2f;
        background: #cde4ff;
        border-top: solid 5px #5989cf;
        border-bottom: solid 5px #5989cf;
        }
        .box4 p {
            margin: 0; 
            padding: 0;
        }
        .box7{
        padding: 0.5em 1em;
        margin: 2em 0;
        color: #232323;
        background: #fff8e8;
        border-left: solid 10px #6efff3;
        }
        .box7 p {
            margin: 0; 
            padding: 0;
        }
    </style>
</head>

<!--設定入力-->
<div class="box4">
    <h1>設定画面です</h1><br>
    <h2>コンテンツ閲覧のため、以下項目を設定してください。 </h2>
    
    <div>
        <h1>秘密鍵とweb3プロバイダアドレスを設定し保存します</h1><br>
        <!-- init App (use PrivateKey,web3ProviderURI)-->
        <h2>Set PrivateKey-web3ProviderURI.</h2>
        <span>
        <div class="box7">

        <!-- 入力　-->
            <p>入力欄にあなたの利用するweb3 プロバイダアドレスを入力 --->:
                <input type="text"  name="prov1" id="prov1" style="width:200px">
            </p>
            <p>・入力欄にあなたの秘密鍵を0x形式で入力(Input private-key) --->:
                <input type="password"  name="privateKey1" id="privateKey1" style="width:200px">
            </p>
                <p>・入力したらボタンをクリック(Click button to save private-key and web3-provider-URI)</p><br>
                <button onclick="setKey()"> 秘密鍵keyとWeb3プロバイダを保存</button>
        </div>
        
        <!--選択したファイルをロード-->
        <p>※鍵とプロバイダを設定したcsvファイルを読み込めます。[providerURI,PrivateKey　の2値の書かれたcsvファイル]</p>
        <br>
        <!--設定入力 csvファイルで初期設定-->
        <form name="myform">
            load csv :
            <input name="myfile" type="file" id="input" accept=".csv"/>
        </form>
        <br>
        <!--認証結果ファイルを入力、csvファイル、
            
            通常：秘密鍵とweb3.js-イーサリアムネットワークコントラクトによる認証。認証できたときタイムスタンプや秘密鍵とアプリと認証時のデータを基にした出力ファイルを保存させる。
            非常時：ネットが使えないとき、秘密鍵と出力ファイルを用いて10分から数時間ぐらいの制約をかけて読める。10分ごとに終了する動作を行い、ユーザーの読書に制約を与える。
            もしネットにつなげないローカル下でも本を制約をつけながら読めるようにする為のもの。
            なお、秘密鍵と出力ファイルは対にならないと動作しない。
            もし本を誰かに読ませるならば秘密鍵と出力ファイルを渡さないといけないが、それはアカウントの譲渡に当たる。
            誰がカギを意図的に紛失させたかがわかるのでユーザーは鍵を不当に流すことはしたくないハズ。
        -->

        <!--
            １．ユーザーの秘密鍵を入力とする。
            ２．秘密鍵から公開鍵を算出し、公開鍵で、認証時のアプリ内部の共通鍵もしくは共通データとブロック番号、タイムスタンプなどをRSA暗号化。
            ３．暗号化したファイルを、閲覧時の栞データ、ここえは”公開栞”データと呼称して出力する。なお栞には読者コメントなども含めていい。
            ４．オフチェーン、オフラインにおいてもアプリシャットダウン時間に制約があるものの、秘密鍵と公開栞があれば閲覧できるようにする。

        -->


        <form name="myform2">
            load json :
            <input name="myfile2" type="file" id="input2" accept=".csv"/>
        </form>
        <br>
        <p>プロバイダアドレスの例：'wss://mainnet.infura.io/ws/v3/39a7b8b9d7924f8398xxxxxxxxxxxxab'</p>
        <p>WebsocketProvider使用。</p>
        <p>秘密鍵とweb3プロバイダアドレスはNode.js-ElectronのChromiumブラウザのsessionStrageに一時保存されます。</p>
        </span>
        <br><br><br>
    </div>

<!--ワンタイムパスワード認証画面に遷移-->
<div class="box4">

    <p>データ読み込み結果</p>
    <p id="settingResult"> no data </p>

    <h1></h1><br>
    <h2>設定ボタンを押した後、以下のボタンで次に進みます。 </h2>
    <span>
        <div class="box7">
            <button onclick="gotoOtp()"> 次のページに進む</button>
        </div>
    </span>







<!--メインスクリプト -->
<script type="text/javascript" src="./set.js"></script>

<!--footer-->
<footer>Author NZRI (https://github.com/NZRI-AZRI) "license": "non-free computer software , Proprietary" , "name": "Katusya Nishizawa" , "email": "nzri2azri@gmail.com"</footer>

{
    "name": "Crypto-bon(Crybon)",
    "version": "1.0.0",
    "description": "Local app of [web3-otp-contents-viewer]",
    "main": "main.js",
    "scripts": {
      "test": "echo \"Error: no test specified\" && exit 1"
    },
    "keywords": ["web3","otp","contents","viewer"],
    "author": {
      "name": "Katusya Nishizawa",
      "email": "nzri2azri@gmail.com",
      "url": "https://github.com/NZRI-AZRI"
    },
    "license": "non-free computer software , Proprietary"
}


</body>

</html>

<!--
/*
{
  "name": "Crypto-bon(Crybon)",
  "version": "1.0.0",
  "description": "Local app of [web3-otp-contents-viewer]",
  "main": "main.js",
  "scripts": {
    "test": "echo \"Error: no test specified\" && exit 1"
  },
  "keywords": ["web3","otp","contents","viewer"],
  "author": {
    "name": "Katusya Nishizawa",
    "email": "nzri2azri@gmail.com",
    "url": "https://github.com/NZRI-AZRI"
  },
  "license": "non-free computer software , Proprietary"
}
*/
-->



